import { Button } from "std-widgets.slint";
import { Theme } from "./theme.slint";

export component ZoomSlider inherits Rectangle {
    in-out property <float> zoom-level: 100.0;
    property <float> min-value: 100.0;
    property <float> max-value: 400.0;
    property <float> step-size: 25.0;
    property <float> range: max(1.0, max-value - min-value);
    property <float> normalized: range == 0 ? 0.0 : max(0.0, min(1.0, (zoom-level - min-value) / range));

    height: 40px;
    horizontal-stretch: 1;
    border-width: 1px;
    border-radius: 4px;
    border-color: Theme.colors.border_default;
    background: Theme.colors.bg_card;

    HorizontalLayout {
        padding-left: 12px;
        padding-right: 12px;
        spacing: 8px;

        Rectangle {
            horizontal-stretch: 1;
        }

        Button {
            text: "-";
            width: 32px;
            clicked => {
                if zoom-level > min-value {
                    zoom-level = max(min-value, zoom-level - step-size);
                }
            }
        }

        Rectangle {
            width: 50px;
            height: 100%;

            Text {
                text: round(zoom-level) + "%";
                font-size: 10pt;
                color: Theme.colors.text_secondary;
                vertical-alignment: center;
                horizontal-alignment: center;
            }
        }

        Rectangle {
            width: 150px;
            height: 100%;

            Rectangle {
                width: 100%;
                y: (parent.height - 4px) / 2;
                height: 4px;
                border-radius: 2px;
                background: Theme.colors.bg_secondary;

                Rectangle {
                    width: normalized * parent.width;
                    height: 100%;
                    background: Theme.colors.accent_primary;
                    border-radius: 2px;
                }
            }

            Rectangle {
                width: 12px;
                height: 12px;
                x: normalized * (parent.width - self.width);
                y: (parent.height - self.height) / 2;
                border-radius: 6px;
                background: Theme.colors.accent_primary;
                border-width: 2px;
                border-color: white;
            }

            TouchArea {
                width: 100%;
                height: 100%;
                mouse-cursor: pointer;
            }
        }

        Button {
            text: "+";
            width: 32px;
            clicked => {
                if zoom-level < max-value {
                    zoom-level = min(max-value, zoom-level + step-size);
                }
            }
        }
    }
}
